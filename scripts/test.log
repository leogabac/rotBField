units micro
atom_style hybrid ellipsoid paramagnet bond
boundary s s p
dimension 2
neighbor 1.0 nsq
neigh_modify every 1 delay 1 check yes
pair_style hybrid lj/cut/dipole/cut 0 200
bond_style biharmonic

### ---Create Particles and Region--- ###
read_data ./test.lmpdata
  orthogonal box = (0 0 -15) to (300 300 15)
  1 by 1 by 1 MPI processor grid
  reading atoms ...
  400 atoms
  scanning bonds ...
  1 = max bonds/atom
  200 ellipsoids
  reading bonds ...
  200 bonds
  1 = max # of 1-2 neighbors
  0 = max # of 1-3 neighbors
  0 = max # of 1-4 neighbors
  1 = max # of special neighbors
  special bonds CPU = 0.0410361 secs
  read_data CPU = 0.0761199 secs
group Atoms type 1
200 atoms in group Atoms
group Traps type 2
200 atoms in group Traps
mass * 1
group Atoms_1 type 1
200 atoms in group Atoms_1

### ---Variables--- ###

## magnetic field
variable Bmag atom 5.322907795715563e-05
variable freq atom 0.0
variable theta atom 0.0
variable phi atom 0.0

variable fieldx atom v_Bmag*sin(PI/2/60*(time-60e6)/1e6)*(time>=60e6)
variable fieldy atom 0
variable fieldz atom v_Bmag/60e6*time*(time<60e6)+v_Bmag*cos(PI/2/60*(time-60e6)/1e6)*(time>=60e6)

### ---Fixes--- ###

fix 	1 Atoms setdipole v_fieldx v_fieldy v_fieldz 0
fix 	2 Atoms bd 300 0.001 408432

fix 	3 Atoms addforce 0 0 -0.0

fix 	5 all enforce2d_bd

###Â ---Run Commands--- ###
timestep 	10000.0
dump 	3 all custom 5 ./test.lammpstrj id type x	 y	 z	 mux	 muy	 muz
thermo_style 	custom step atoms
thermo 	100
run 	12000
Neighbor list info ...
  update every 1 steps, delay 1 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 201
  ghost atom cutoff = 201
  3 neighbor lists, perpetual/occasional/extra = 3 0 0
  (1) pair lj/cut/dipole/cut, perpetual, skip from (3)
      attributes: half, newton on
      pair build: skip
      stencil: none
      bin: none
  (2) fix setdipole, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
  (3) neighbor class addition, perpetual, half/full from (2)
      attributes: half, newton on
      pair build: halffull/newton
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 8.41 | 8.41 | 8.41 Mbytes
Step Atoms 
       0      400 
     100      400 
     200      400 
     300      400 
     400      400 
     500      400 
     600      400 
     700      400 
     800      400 
     900      400 
    1000      400 
    1100      400 
    1200      400 
    1300      400 
    1400      400 
    1500      400 
    1600      400 
    1700      400 
    1800      400 
    1900      400 
    2000      400 
    2100      400 
    2200      400 
    2300      400 
    2400      400 
    2500      400 
    2600      400 
    2700      400 
    2800      400 
    2900      400 
    3000      400 
    3100      400 
    3200      400 
    3300      400 
    3400      400 
    3500      400 
    3600      400 
    3700      400 
    3800      400 
    3900      400 
    4000      400 
    4100      400 
    4200      400 
    4300      400 
    4400      400 
    4500      400 
    4600      400 
    4700      400 
    4800      400 
    4900      400 
    5000      400 
    5100      400 
    5200      400 
    5300      400 
    5400      400 
    5500      400 
    5600      400 
    5700      400 
    5800      400 
    5900      400 
    6000      400 
    6100      400 
    6200      400 
    6300      400 
    6400      400 
    6500      400 
    6600      400 
    6700      400 
    6800      400 
    6900      400 
    7000      400 
    7100      400 
    7200      400 
    7300      400 
    7400      400 
    7500      400 
    7600      400 
    7700      400 
    7800      400 
    7900      400 
    8000      400 
    8100      400 
    8200      400 
    8300      400 
    8400      400 
    8500      400 
    8600      400 
    8700      400 
    8800      400 
    8900      400 
    9000      400 
    9100      400 
    9200      400 
    9300      400 
    9400      400 
    9500      400 
    9600      400 
    9700      400 
    9800      400 
    9900      400 
   10000      400 
   10100      400 
   10200      400 
   10300      400 
   10400      400 
   10500      400 
   10600      400 
   10700      400 
   10800      400 
   10900      400 
   11000      400 
   11100      400 
   11200      400 
   11300      400 
   11400      400 
   11500      400 
   11600      400 
   11700      400 
   11800      400 
   11900      400 
   12000      400 
Loop time of 21.2834 on 1 procs for 12000 steps with 400 atoms

Performance: 487141084335203.500 ns/day, 0.000 hours/ns, 563.821 timesteps/s
86.1% CPU use with 1 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 9.7917     | 9.7917     | 9.7917     |   0.0 | 46.01
Bond    | 0.21641    | 0.21641    | 0.21641    |   0.0 |  1.02
Neigh   | 3.422      | 3.422      | 3.422      |   0.0 | 16.08
Comm    | 0.1587     | 0.1587     | 0.1587     |   0.0 |  0.75
Output  | 5.4076     | 5.4076     | 5.4076     |   0.0 | 25.41
Modify  | 2.0993     | 2.0993     | 2.0993     |   0.0 |  9.86
Other   |            | 0.1877     |            |       |  0.88

Nlocal:    400 ave 400 max 400 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    0 ave 0 max 0 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    9023 ave 9023 max 9023 min
Histogram: 1 0 0 0 0 0 0 0 0 0
FullNghs:  18046 ave 18046 max 18046 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 18046
Ave neighs/atom = 45.115
Ave special neighs/atom = 1
Neighbor list builds = 3526
Dangerous builds = 2697
Total wall time: 0:00:22
